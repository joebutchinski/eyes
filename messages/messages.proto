syntax = "proto3";

package messages;

message ProbeACK {
    enum Type {
        HELLO = 0;
        RESULT = 1;
    }
    Type type = 1;
    string id = 2;
    string auth = 3;
    string label = 4;
    ProbeResult result = 5;
}

message ProbeResult {
    enum Type {
        NOOP = 0;
        TCP = 1;
        ICMP = 2;
    }
    Type type = 1;
    string host = 2;
    string probeId = 3;
    int64 timestamp = 4;
    bytes data = 5;
}

message ProbeCommand {
    enum Type {
        NOOP = 0;
        TCP = 1;
        ICMP = 2;
    }
    string host = 1;
    Type type = 2;
    map<string,string> parameters = 3;
}
